consider using nd arrays throughout
